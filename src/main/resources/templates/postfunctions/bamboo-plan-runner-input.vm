#*
 * Copyright 2020 clocken
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
*#

<tr>
    <td class="fieldLabelArea">
        $i18n.getText("bamboo-plan-runner.postfunction.label.applink")
    </td>
    <td nowrap>
        <select name="selectedAppLink" id="selectedAppLinkId">
        #foreach( $appLink in $appLinks )
            <option value="$appLink.rpcUrl.toString()"
            #if( $appLink.rpcUrl.toString().equals($selectedAppLink) )
                selected
            #end
            >$appLink.name</option>
        #end
        </select>
    </td>
</tr>

<tr>
    <td class="fieldLabelArea">
        $i18n.getText("bamboo-plan-runner.postfunction.label.plan")
    </td>
    <td nowrap>
        <select name="selectedPlan" id="selectedPlanId">
        #foreach( $plan in $plans )
            <option value="$plan.key"
            #if( $plan.key.equals($selectedPlan) )
                selected
            #end
            >$plan.name - $plan.key</option>
        #end
        </select>
    </td>
</tr>

#foreach( $plan in $plans )
    <table id="$plan.key_table">
        <thead>
            <tr>
                <th>
                    $i18n.getText("bamboo-plan-runner.postfunction.variable.table.header.use.variable")
                </th>
                <th>
                    $i18n.getText("bamboo-plan-runner.postfunction.variable.table.header.variable.name")
                </th>
                <th>
                    $i18n.getText("bamboo-plan-runner.postfunction.variable.table.header.value")
                </th>
            <tr>
        <thead>
        <tbody>
        #foreach( $variable in $plan.variables )
            <tr>
                <td>
                    <input type="checkbox" name="use_${variable}" value="$variable" />
                </td>
                <td>
                    $variable
                </td>
                <td>
                    <select name="selectedFieldFor_${variable}" id="selectedFieldFor_${variable}_Id">
                    #set( $selectedField = "$selectedFieldFor_$variable" )
                    #set( $selectedFieldForThisParameter = "#evaluate( $selectedField )" )
                    #foreach( $field in $fields )
                        <option value="$field.id"
                        #if( $field.id.equals($selectedFieldForThisParameter) )
                            selected
                        #end
                        >$i18n.getText($field.nameKey)</option>
                    #end
                    </select>
                </td>
            </tr>
        #end
        </tbody>
    </table>
#end